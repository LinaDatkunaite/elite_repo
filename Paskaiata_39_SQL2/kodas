--1.
--SELECT ASMENS_KODAS, VARDAS, PAVARDĖ from DARBUOTOJAS WHERE ASMENS_KODAS LIKE '_880720%'

--2.
--SELECT DIRBA_NUO, ASMENS_KODAS from DARBUOTOJAS WHERE DIRBA_NUO BETWEEN '2009-10-30' and '2012-11-11'

--3.
--SELECT VARDAS, SKYRIUS_ID, PROJEKTAS_ID from DARBUOTOJAS WHERE SKYRIUS_ID in (2,3)

--4.
--SELECT  VARDAS, PAVARDĖ, ASMENS_KODAS from DARBUOTOJAS WHERE PAVARDĖ LIKE '%ė'

--5.
--SELECT  * from DARBUOTOJAS WHERE ASMENS_KODAS LIKE '_____12%'
--SELECT * FROM PROJEKTAS WHERE PAVADINIMAS like '_a%'

--6.
--SELECT VARDAS, PAVARDĖ FROM DARBUOTOJAS WHERE PAREIGOS is NULL

--7.
--SELECT VARDAS, PAVARDĖ, DIRBA_NUO, PAREIGOS from DARBUOTOJAS WHERE DIRBA_NUO > '2011-02-12' and PAREIGOS = 'Programuotojas'

--8.
--SELECT VARDAS, PAVARDĖ, SKYRIUS_ID, PROJEKTAS_ID FROM DARBUOTOJAS WHERE SKYRIUS_ID = 2 AND PROJEKTAS_ID =1

--9.
--SELECT VARDAS FROM DARBUOTOJAS WHERE VARDAS NOT like 'A%'

--10.
--SELECT VARDAS, PAVARDĖ, DIRBA_NUO from DARBUOTOJAS ORDER by DIRBA_NUO ASC

--11.
--SELECT VARDAS, PAVARDĖ, DIRBA_NUO from DARBUOTOJAS ORDER by DIRBA_NUO DESC

--12.
--SELECT max(PROJEKTAS_ID) as Didziausias_id, min(PROJEKTAS_ID) as Maziausias_id FROM DARBUOTOJAS

--13.
--SELECT PROJEKTAS_ID, count(VARDAS) as Zmonius_sk FROM DARBUOTOJAS GROUP by PROJEKTAS_ID ORDER by PROJEKTAS_ID asc

--14.
--SELECT PROJEKTAS_ID, count(VARDAS) as Zmonius_sk FROM DARBUOTOJAS GROUP by PROJEKTAS_ID having count(VARDAS) > 3 ORDER by PROJEKTAS_ID asc

--15.
--SELECT PROJEKTAS_ID, PAREIGOS, count(VARDAS) FROM DARBUOTOJAS GROUP by PROJEKTAS_ID HAVING PAREIGOS = 'Programuotojas'



2 DALIS

--1.
--SELECT VARDAS, PAVARDĖ, PAVADINIMAS from DARBUOTOJAS JOIN PROJEKTAS on DARBUOTOJAS.PROJEKTAS_ID = PROJEKTAS.ID

--2.
--SELECT VARDAS, PAVARDĖ, PAVADINIMAS from DARBUOTOJAS JOIN PROJEKTAS on DARBUOTOJAS.PROJEKTAS_ID = PROJEKTAS.ID WHERE PROJEKTAS.PAVADINIMAS = 'Galerija'

--3.
--SELECT DARBUOTOJAS.VARDAS, DARBUOTOJAS.PAVARDĖ, SKYRIUS.PAVADINIMAS as 'SKYRIUS', PROJEKTAS.PAVADINIMAS as 'PROJEKTAS' from DARBUOTOJAS
--JOIN PROJEKTAS on DARBUOTOJAS.PROJEKTAS_ID = PROJEKTAS.ID
--JOIN SKYRIUS on DARBUOTOJAS.SKYRIUS_ID = SKYRIUS.ID
--WHERE PROJEKTAS.PAVADINIMAS = 'Projektų valdymas' AND SKYRIUS.PAVADINIMAS = 'Pardavimų'


--4.
--SELECT DARBUOTOJAS.VARDAS, DARBUOTOJAS.PAVARDĖ, PROJEKTAS.PAVADINIMAS as 'PROJEKTAS' from DARBUOTOJAS
--JOIN PROJEKTAS on DARBUOTOJAS.PROJEKTAS_ID = PROJEKTAS.ID
--WHERE PROJEKTAS.PAVADINIMAS = 'Projektų valdymas' AND DARBUOTOJAS.ASMENS_KODAS like '4%' or DARBUOTOJAS.ASMENS_KODAS like '6%'

--5.
--SELECT SKYRIUS.PAVADINIMAS, count(DARBUOTOJAS.VARDAS) as 'DARBUOTOJU SK.' FROM DARBUOTOJAS JOIN SKYRIUS on DARBUOTOJAS.SKYRIUS_ID = SKYRIUS.ID
--GROUP by SKYRIUS.PAVADINIMAS

--6.
--SELECT SKYRIUS.PAVADINIMAS, count(DARBUOTOJAS.VARDAS) as 'DARBUOTOJU SK.' FROM DARBUOTOJAS JOIN SKYRIUS on DARBUOTOJAS.SKYRIUS_ID = SKYRIUS.ID
--GROUP by SKYRIUS.PAVADINIMAS HAVING count(DARBUOTOJAS.VARDAS) >=5


--7.
--SELECT DARBUOTOJAS.VARDAS, DARBUOTOJAS.PAVARDĖ, DARBUOTOJAS.PAREIGOS, SKYRIUS.PAVADINIMAS from DARBUOTOJAS
--LEFT JOIN SKYRIUS on DARBUOTOJAS.SKYRIUS_ID = SKYRIUS.id
--WHERE DARBUOTOJAS.PAREIGOS != 'Vadovas' or DARBUOTOJAS.VARDAS ISNULL

--8.
--INSERT INTO DARBUOTOJAS (ASMENS_KODAS, VARDAS, PAVARDĖ, DIRBA_NUO) VALUES ('38807117896', 'Pranas', 'Logis', '2009-11-12')


--9.
--SELECT DARBUOTOJAS.VARDAS, DARBUOTOJAS.PAVARDĖ, SKYRIUS.PAVADINIMAS from DARBUOTOJAS
--LEFT JOIN SKYRIUS on DARBUOTOJAS.SKYRIUS_ID = SKYRIUS.id


--10.
--SELECT VARDAS, PAVARDĖ, PAVADINIMAS from DARBUOTOJAS JOIN PROJEKTAS on DARBUOTOJAS.PROJEKTAS_ID = PROJEKTAS.ID
--WHERE PAVADINIMAS in (SELECT  PROJEKTAS.PAVADINIMAS from DARBUOTOJAS
--JOIN PROJEKTAS on DARBUOTOJAS.PROJEKTAS_ID = PROJEKTAS.ID GROUP by PROJEKTAS.PAVADINIMAS HAVING count(DARBUOTOJAS.VARDAS) >4)


--11.
--SELECT VARDAS, PAVARDĖ, PAVADINIMAS, BAZINIS_ATLYGINIMAS, PRIEDAI from DARBUOTOJAS JOIN PROJEKTAS on DARBUOTOJAS.PROJEKTAS_ID = PROJEKTAS.ID
--WHERE PAVADINIMAS in (SELECT  PROJEKTAS.PAVADINIMAS from DARBUOTOJAS
--JOIN PROJEKTAS on DARBUOTOJAS.PROJEKTAS_ID = PROJEKTAS.ID GROUP by PROJEKTAS.PAVADINIMAS HAVING count(DARBUOTOJAS.VARDAS) >4)


--SELECT SUM(BAZINIS_ATLYGINIMAS+PRIEDAI) AS 'BENDRA SUMA', round(avg(BAZINIS_ATLYGINIMAS+PRIEDAI),1) AS 'VIDUTINIS ATLYGINIMAS', min(BAZINIS_ATLYGINIMAS+PRIEDAI) AS 'MAX ATLYGINIMAS', max(BAZINIS_ATLYGINIMAS+PRIEDAI) AS 'MIN ATLYGINIMAS' from DARBUOTOJAS JOIN PROJEKTAS on DARBUOTOJAS.PROJEKTAS_ID = PROJEKTAS.ID
--WHERE PAVADINIMAS in (SELECT  PROJEKTAS.PAVADINIMAS from DARBUOTOJAS
--JOIN PROJEKTAS on DARBUOTOJAS.PROJEKTAS_ID = PROJEKTAS.ID GROUP by PROJEKTAS.PAVADINIMAS HAVING count(DARBUOTOJAS.VARDAS) >4)




SELECT product_order.order_id, order_.date_, customer.l_name, product.price, product.name from order_
join customer on customer.id = order_.customer_id
join product_order on order_.id = product_order.order_id
JOIN product on product_order.product_id = product.id

SELECT order_.id, product.name, customer.l_name as 'name', product_order.quantity, product.price, product_order.quantity*product.price as 'total' from order_
join customer on customer.id = order_.customer_id
join product_order on order_.id = product_order.order_id
JOIN product on product_order.product_id = product.id

SELECT product.name, sum(product_order.quantity) as 'quantity', product.price, sum(product_order.quantity)*product.price as 'total'
 FROM product_order left join product on product_order.product_id = product.id GROUP by	 product.name


